<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 	int b_id;
	int br_id;
	String bc_id;
	String b_title;
	String b_content;
	Date b_date; -->
	
<mapper namespace="board">
	<resultMap type="com.spring.moon.dto.BoardDTO"
		id="BoardDTO">
		<result property="b_id" column="board_no" />
		<result property="br_id" column="room_id" />
		<result property="bc_id" column="cust_id" />
		<result property="b_title" column="board_title" />
		<result property="b_content" column="board_content" />
		<result property="b_date" column="board_date" />
	</resultMap>
	<insert id='write_bbs'>
		<selectKey keyProperty="e_id" resultType="Integer" order="BEFORE"> 
		SELECT 
			nvl(TO_NUMBER(MAX(board_no)+1),0)
		FROM
			board
		</selectKey>
		INSERT INTO board 
		VALUES ((SELECT NVL(MAX(board_no)+1,1) FROM board), #{br_id}, #{bc_id}, #{b_title},#{b_content}, sysdate)
	</insert>
	
	<select id="bbs_all" resultMap="BoardDTO">
		SELECT *
		FROM board
	</select>
	
<!-- 	<select id = "get_bbs" resultType="BoardDTO">
		select b.*, (select u_id from user u where u.u_no = b.b_owner) b_ownernick from bbs b where b.b_no = #{b_no}
	</select> -->


</mapper>